#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Foundation Pre-Commit Hook
# Runs secret scanning and lint checks before commit

echo "ðŸ” Running pre-commit checks..."

# Secret Scanner
echo "â”œâ”€â”€ Secret scanning..."
if ! python scripts/ci/secret-scanner.py --staged; then
  echo "âŒ Secrets detected! Please remove before committing."
  echo "   Run: python scripts/ci/secret-scanner.py --staged --fix"
  exit 1
fi

# Type checking (fast)
echo "â”œâ”€â”€ Type checking..."
if ! pnpm run typecheck:workers 2>/dev/null; then
  echo "âš ï¸  Type errors detected (continuing...)"
fi

# Lint staged files
echo "â”œâ”€â”€ Linting..."
if command -v lint-staged >/dev/null 2>&1; then
  lint-staged
fi

echo "âœ… Pre-commit checks passed"
