{
  "projectId": "run_mltssz17_d52cfcba31ee",
  "projectName": "Global-Claw",
  "generatedAt": "2026-02-19T18:35:00Z",
  "version": "1.0",
  "summary": {
    "totalTasks": 24,
    "totalMarketingTasks": 3,
    "byCategory": {"devops": 2, "database": 2, "backend": 7, "frontend": 4, "security": 2, "integration": 3, "testing": 1, "documentation": 1},
    "byPriority": {"p0": 20, "p1": 4},
    "criticalPath": ["task-001", "task-003", "task-005", "task-008", "task-013"],
    "buildPhases": 8,
    "estimatedTotalEffort": "~160-200 engineer-hours (AI-assisted)"
  },
  "intakeConstraints": {
    "techStack": "Cloudflare Workers + Durable Objects + Workflows + D1 + R2 + KV + Queues + Workers AI + Pages + SvelteKit",
    "teamSize": "1-2 engineers + AI agents",
    "budgetRange": "bootstrap",
    "mustAvoid": ["AWS", "GCP", "Azure", "US market"],
    "complianceRequirements": ["GDPR", "Stripe Tax"]
  },
  "buildPhases": [
    {"id": 1, "name": "Infrastructure", "taskIds": ["task-001", "task-002"]},
    {"id": 2, "name": "Database", "taskIds": ["task-003", "task-004"]},
    {"id": 3, "name": "Backend", "taskIds": ["task-005", "task-006", "task-007", "task-008", "task-009", "task-010", "task-011"]},
    {"id": 4, "name": "Frontend", "taskIds": ["task-012", "task-013", "task-014", "task-015"]},
    {"id": 5, "name": "Integrations", "taskIds": ["task-016", "task-017", "task-018"]},
    {"id": 6, "name": "Testing", "taskIds": ["task-019"]},
    {"id": 7, "name": "Marketing", "taskIds": ["mkt-001", "mkt-002", "mkt-003"]},
    {"id": 8, "name": "Launch", "taskIds": ["task-020", "task-021", "task-022", "task-023", "task-024"]}
  ],
  "tasks": [
    {
      "id": "task-001",
      "type": "code",
      "title": "Provision Cloudflare infrastructure",
      "description": "Create wrangler.jsonc, provision D1/KV/R2/Queues/DO",
      "category": "devops",
      "priority": "p0",
      "buildPhase": 1,
      "dependencies": [],
      "integrationContract": {"exports": ["wrangler.jsonc"], "databaseMutations": ["creates D1 global-claw-primary"]},
      "naomiPrompt": "Create wrangler.jsonc for Global-Claw with D1 database 'global-claw-primary', KV namespaces SESSION_KV/RATE_LIMIT_KV/BOT_CONFIG_KV, R2 bucket 'global-claw-transcripts', Queues commission-queue/email-queue, Durable Object TenantBot. Run wrangler commands to create all resources. Add compatibility_date 2025-09-25.",
      "filesToCreate": ["wrangler.jsonc", ".dev.vars.example"],
      "estimatedEffort": "xs",
      "git": {"branchName": "feature/task-001-infra", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-002",
      "type": "code",
      "title": "Setup CI/CD GitHub Actions",
      "description": "Deploy and preview workflows",
      "category": "devops",
      "priority": "p0",
      "buildPhase": 1,
      "dependencies": ["task-001"],
      "integrationContract": {"exports": [".github/workflows/deploy.yml"]},
      "naomiPrompt": "Create .github/workflows/deploy.yml triggering on push to main: checkout, setup node 20, npm ci, tsc --noEmit, vitest, wrangler deploy. Use CLOUDFLARE_API_TOKEN secret.",
      "filesToCreate": [".github/workflows/deploy.yml"],
      "estimatedEffort": "xs",
      "git": {"branchName": "feature/task-002-ci", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-003",
      "type": "code",
      "title": "Design tenant data model with D1 migrations",
      "description": "Create all D1 tables: tenants, bots, conversations, messages, resellers, commissions",
      "category": "database",
      "priority": "p0",
      "buildPhase": 2,
      "dependencies": ["task-001"],
      "integrationContract": {"exports": ["migrations/*.sql"], "databaseMutations": ["creates all schema tables"]},
      "naomiPrompt": "Create D1 migrations: 0001_tenants (id text PK, reseller_id, plan, status, created_at), 0002_bots (id text PK, tenant_id FK, telegram_token, bot_username, pack_id, config_json), 0003_conversations (id text PK, tenant_id FK, telegram_chat_id, started_at), 0004_messages (id text PK, conversation_id FK, role, content, tokens_used, created_at), 0005_resellers (id text PK, stripe_connect_id, tier, parent_reseller_id, commission_rate), 0006_commissions (id text PK, reseller_id FK, tenant_id FK, amount, period, paid_at). All tables have tenant_id for isolation.",
      "filesToCreate": ["migrations/0001_tenants.sql", "migrations/0002_bots.sql", "migrations/0003_conversations.sql", "migrations/0004_messages.sql", "migrations/0005_resellers.sql", "migrations/0006_commissions.sql"],
      "estimatedEffort": "s",
      "git": {"branchName": "feature/task-003-schema", "baseBranch": "main", "mergeStrategy": "human-review-required", "conflictSensitiveFiles": ["migrations/*.sql"]}
    },
    {
      "id": "task-004",
      "type": "code",
      "title": "Setup Drizzle ORM with D1",
      "description": "Drizzle schema matching migrations + db client",
      "category": "database",
      "priority": "p0",
      "buildPhase": 2,
      "dependencies": ["task-003"],
      "integrationContract": {"exports": ["src/db/schema.ts", "db instance"]},
      "naomiPrompt": "Install drizzle-orm drizzle-kit. Create src/db/schema.ts with Drizzle table definitions for tenants, bots, conversations, messages, resellers, commissions. Create src/db/index.ts exporting db = drizzle(env.DB). Create drizzle.config.ts. Generate types with drizzle-kit generate:sqlite.",
      "filesToCreate": ["src/db/schema.ts", "src/db/index.ts", "drizzle.config.ts"],
      "estimatedEffort": "s",
      "git": {"branchName": "feature/task-004-drizzle", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-005",
      "type": "code",
      "title": "Build auth system (email+password + session KV)",
      "description": "Register, login, logout, session middleware with bcrypt",
      "category": "security",
      "priority": "p0",
      "buildPhase": 3,
      "dependencies": ["task-004"],
      "integrationContract": {"exports": ["authMiddleware", "register/login/logout"], "apiEndpoints": ["POST /api/auth/register", "POST /api/auth/login"]},
      "naomiPrompt": "Create src/lib/auth.ts with register(email, password) using bcrypt hash, login(email, password) verifying hash + creating session token in KV with 24h TTL, logout deleting KV token. Create src/middleware/auth.ts validating session token on API requests. Add migrations/0007_users.sql (id, email, password_hash, role, tenant_id, created_at).",
      "filesToCreate": ["src/lib/auth.ts", "src/middleware/auth.ts", "migrations/0007_users.sql"],
      "estimatedEffort": "m",
      "securityReviewRequired": true,
      "git": {"branchName": "feature/task-005-auth", "baseBranch": "main", "mergeStrategy": "human-review-required"}
    },
    {
      "id": "task-006",
      "type": "code",
      "title": "Build TenantBot Durable Object",
      "description": "DO handling all Telegram updates for a tenant, routing to LLM, applying pack config",
      "category": "backend",
      "priority": "p0",
      "buildPhase": 3,
      "dependencies": ["task-004"],
      "integrationContract": {"exports": ["TenantBot class"], "apiEndpoints": ["POST /bot/:tenantId/webhook"]},
      "naomiPrompt": "Create src/durable-objects/tenant-bot.ts exporting TenantBot extends DurableObject. In fetch(): validate Telegram HMAC signature, parse update, load pack config from state, route message to LLM router, send response via Telegram sendMessage API. Store conversation in durable storage. Enforce per-tenant monthly token budget (fail gracefully if exceeded). Add to wrangler.jsonc durable_objects binding.",
      "filesToCreate": ["src/durable-objects/tenant-bot.ts"],
      "estimatedEffort": "l",
      "securityReviewRequired": true,
      "git": {"branchName": "feature/task-006-tenant-bot", "baseBranch": "main", "mergeStrategy": "human-review-required"}
    },
    {
      "id": "task-007",
      "type": "code",
      "title": "Build LLM router (DeepSeek + GPT-4o-mini fallback)",
      "description": "Route to DeepSeek by default, fallback to OpenAI on error",
      "category": "backend",
      "priority": "p0",
      "buildPhase": 3,
      "dependencies": [],
      "integrationContract": {"exports": ["LLMRouter.route(messages, tenantId)"]},
      "naomiPrompt": "Create src/lib/llm-router.ts with route(messages, tenantId) method. Try DeepSeek API first (api.deepseek.com OpenAI-compatible), fallback to OpenAI GPT-4o-mini on error. Track token usage per tenant. Return {response, tokensUsed, model}.",
      "filesToCreate": ["src/lib/llm-router.ts"],
      "estimatedEffort": "m",
      "git": {"branchName": "feature/task-007-llm-router", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-008",
      "type": "code",
      "title": "Build Telegram bot provisioning Workflow",
      "description": "Stripe webhook -> register bot -> spawn DO -> send welcome message",
      "category": "backend",
      "priority": "p0",
      "buildPhase": 3,
      "dependencies": ["task-003", "task-006"],
      "integrationContract": {"exports": ["ProvisionTenantWorkflow"], "apiEndpoints": ["POST /webhooks/stripe"]},
      "naomiPrompt": "Create src/workflows/provision-tenant.ts with ProvisionTenantWorkflow. On Stripe checkout.session.completed: call Telegram BotFather API to register bot, get bot token, create tenant in D1, get TenantBot DO stub and init, send Telegram welcome message with dashboard link. Add workflow binding to wrangler.jsonc.",
      "filesToCreate": ["src/workflows/provision-tenant.ts"],
      "estimatedEffort": "m",
      "securityReviewRequired": true,
      "git": {"branchName": "feature/task-008-provision-workflow", "baseBranch": "main", "mergeStrategy": "human-review-required"}
    },
    {
      "id": "task-009",
      "type": "code",
      "title": "Create 5 preset automation pack configs",
      "description": "JSON templates: lead-capture, appointments, faq, review-collection, internal-ops",
      "category": "backend",
      "priority": "p0",
      "buildPhase": 3,
      "dependencies": [],
      "integrationContract": {"exports": ["PackEngine.loadPack(packId, locale)"]},
      "naomiPrompt": "Create src/packs/{lead-capture,appointments,faq,review-collection,internal-ops}.json. Each defines: systemPrompt template, expectedIntents array, responseTemplates object, requiredIntegrations array. Create src/lib/pack-engine.ts with loadPack(packId, locale) loading JSON and interpolating locale strings.",
      "filesToCreate": ["src/packs/lead-capture.json", "src/packs/appointments.json", "src/packs/faq.json", "src/packs/review-collection.json", "src/packs/internal-ops.json", "src/lib/pack-engine.ts"],
      "estimatedEffort": "m",
      "git": {"branchName": "feature/task-009-packs", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-010",
      "type": "code",
      "title": "Telegram webhook handler Worker",
      "description": "Receives Telegram POSTs, validates HMAC, routes to TenantBot DO",
      "category": "backend",
      "priority": "p0",
      "buildPhase": 3,
      "dependencies": ["task-006"],
      "integrationContract": {"exports": ["telegram webhook handler"], "apiEndpoints": ["POST /bot/:botToken/webhook"]},
      "naomiPrompt": "Create src/routes/webhooks/telegram.ts handling POST /bot/:botToken/webhook. Validate Telegram HMAC signature. Look up tenant by botToken in D1. Get TenantBot DO stub by tenantId. Forward update to DO.fetch(). Return 200. Add KV rate limit: 30 req/min per tenant.",
      "filesToCreate": ["src/routes/webhooks/telegram.ts"],
      "estimatedEffort": "s",
      "securityReviewRequired": true,
      "git": {"branchName": "feature/task-010-webhook", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-011",
      "type": "code",
      "title": "Stripe Checkout + Connect integration",
      "description": "Subscription checkout, reseller Connect onboarding, commission payouts",
      "category": "backend",
      "priority": "p0",
      "buildPhase": 3,
      "dependencies": ["task-003"],
      "integrationContract": {"exports": ["createCheckoutSession", "createConnectAccount"], "apiEndpoints": ["POST /api/billing/checkout", "POST /webhooks/stripe"]},
      "naomiPrompt": "Create src/lib/stripe.ts with createCheckoutSession(plan, resellerId) creating Stripe Checkout session with 3 price tiers, automatic_tax enabled. Create createConnectAccount(resellerId) for Stripe Connect onboarding. Handle webhook: checkout.session.completed triggers ProvisionTenantWorkflow. Calculate reseller commission on payment, transfer via Stripe Connect.",
      "filesToCreate": ["src/lib/stripe.ts", "src/routes/api/billing/checkout/+server.ts"],
      "estimatedEffort": "m",
      "securityReviewRequired": true,
      "git": {"branchName": "feature/task-011-stripe", "baseBranch": "main", "mergeStrategy": "human-review-required"}
    },
    {
      "id": "task-012",
      "type": "code",
      "title": "Build tenant dashboard SvelteKit app",
      "description": "Pages: dashboard, conversations, configure, billing. i18n DE/ES/IT/PT-BR",
      "category": "frontend",
      "priority": "p0",
      "buildPhase": 4,
      "dependencies": ["task-005"],
      "integrationContract": {"exports": ["SvelteKit tenant dashboard"], "apiEndpoints": ["GET /api/tenant/stats", "GET /api/tenant/conversations"]},
      "naomiPrompt": "Create SvelteKit app src/routes/dashboard/+page.svelte (bot status, conversation count, resolution rate), /conversations/+page.svelte (paginated log), /configure/+page.svelte (pack selection), /billing/+page.svelte (Stripe portal redirect). Add src/lib/i18n.ts for DE/ES/IT/PT-BR translations. Protect routes with auth middleware.",
      "filesToCreate": ["src/routes/dashboard/+page.svelte", "src/routes/conversations/+page.svelte", "src/routes/configure/+page.svelte", "src/lib/i18n.ts"],
      "estimatedEffort": "l",
      "git": {"branchName": "feature/task-012-dashboard", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-013",
      "type": "code",
      "title": "Build reseller portal SvelteKit pages",
      "description": "Pages: clients, billing, white-label config",
      "category": "frontend",
      "priority": "p0",
      "buildPhase": 4,
      "dependencies": ["task-005"],
      "integrationContract": {"exports": ["Reseller portal pages"], "apiEndpoints": ["GET /api/reseller/clients"]},
      "naomiPrompt": "Create src/routes/reseller/clients/+page.svelte (list, add, suspend tenants), /reseller/billing/+page.svelte (Stripe Connect payout dashboard), /reseller/white-label/+page.svelte (custom domain config, logo upload). Master resellers see sub-reseller hierarchy. Auth required.",
      "filesToCreate": ["src/routes/reseller/clients/+page.svelte", "src/routes/reseller/billing/+page.svelte", "src/routes/reseller/white-label/+page.svelte"],
      "estimatedEffort": "l",
      "git": {"branchName": "feature/task-013-reseller-portal", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-014",
      "type": "code",
      "title": "Build marketing site (SvelteKit SSG multilingual)",
      "description": "global-claw.com with /de/, /es/, /it/, /pt-br/ paths",
      "category": "frontend",
      "priority": "p0",
      "buildPhase": 4,
      "dependencies": [],
      "integrationContract": {"exports": ["Marketing site SSG"]},
      "naomiPrompt": "Create marketing/src/routes/[lang]/+page.svelte (homepage), /[lang]/pricing/+page.svelte, /[lang]/reseller/+page.svelte. Support lang=de/es/it/pt-br. Use SvelteKit SSG adapter-static. Deploy to Cloudflare Pages. Add hreflang tags.",
      "filesToCreate": ["marketing/src/routes/[lang]/+page.svelte", "marketing/src/routes/[lang]/pricing/+page.svelte"],
      "estimatedEffort": "l",
      "git": {"branchName": "feature/task-014-marketing-site", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-015",
      "type": "code",
      "title": "Arabic RTL UI support",
      "description": "Add dir=rtl for Arabic locale in dashboard and marketing",
      "category": "frontend",
      "priority": "p1",
      "buildPhase": 4,
      "dependencies": ["task-012"],
      "integrationContract": {"exports": ["RTL layout system"]},
      "naomiPrompt": "Add src/lib/rtl.css with CSS logical properties. Update src/app.html and +layout.svelte to set dir=rtl when locale=ar. Load Arabic font Cairo from Google Fonts. Test all dashboard components in RTL mode.",
      "filesToCreate": ["src/lib/rtl.css", "src/lib/i18n/ar.json"],
      "estimatedEffort": "m",
      "git": {"branchName": "feature/task-015-rtl", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-016",
      "type": "code",
      "title": "Build transactional email templates (Resend)",
      "description": "Templates: welcome-tenant, bot-live, invoice, reseller-welcome. Localized.",
      "category": "integration",
      "priority": "p0",
      "buildPhase": 5,
      "dependencies": [],
      "integrationContract": {"exports": ["sendEmail(template, recipient, locale)"]},
      "naomiPrompt": "Create src/emails/welcome-tenant.tsx (React Email or Handlebars), bot-live.tsx, invoice.tsx, reseller-welcome.tsx. Create src/lib/email.ts with sendEmail(template, recipient, locale, data) calling Resend API. Support DE/ES/IT/PT-BR locales.",
      "filesToCreate": ["src/emails/welcome-tenant.tsx", "src/lib/email.ts"],
      "estimatedEffort": "m",
      "git": {"branchName": "feature/task-016-email", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-017",
      "type": "code",
      "title": "Cloudflare Analytics Engine event tracking",
      "description": "Track: tenant_provisioned, conversation_started, checkout_completed",
      "category": "integration",
      "priority": "p1",
      "buildPhase": 5,
      "dependencies": [],
      "integrationContract": {"exports": ["track(event, properties)"]},
      "naomiPrompt": "Create src/lib/analytics.ts with track(event, properties) writing to Analytics Engine dataset. Track events: tenant_provisioned, bot_activated, conversation_started, conversation_resolved, checkout_completed. Call from provision-tenant.ts, tenant-bot.ts, billing routes.",
      "filesToCreate": ["src/lib/analytics.ts"],
      "estimatedEffort": "s",
      "git": {"branchName": "feature/task-017-analytics", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-018",
      "type": "code",
      "title": "Cloudflare for SaaS custom hostname API",
      "description": "Premium resellers configure custom domain for white-label",
      "category": "integration",
      "priority": "p1",
      "buildPhase": 5,
      "dependencies": ["task-003"],
      "integrationContract": {"exports": ["createCustomHostname"], "apiEndpoints": ["POST /api/reseller/domain/configure"]},
      "naomiPrompt": "Create src/lib/custom-domains.ts with createCustomHostname(resellerId, hostname) calling Cloudflare for SaaS API. Store hostname mapping in D1. Update Worker routing to check Host header and set reseller context. Return CNAME target for reseller DNS setup.",
      "filesToCreate": ["src/lib/custom-domains.ts", "src/routes/api/reseller/domain/+server.ts"],
      "estimatedEffort": "m",
      "securityReviewRequired": true,
      "git": {"branchName": "feature/task-018-custom-domains", "baseBranch": "main", "mergeStrategy": "human-review-required"}
    },
    {
      "id": "task-019",
      "type": "code",
      "title": "Write integration tests for provisioning flow",
      "description": "E2E test: Stripe checkout -> workflow -> bot registration -> welcome message",
      "category": "testing",
      "priority": "p0",
      "buildPhase": 6,
      "dependencies": ["task-008"],
      "integrationContract": {"exports": ["provisioning.test.ts"]},
      "naomiPrompt": "Create tests/provisioning.test.ts using Vitest + Miniflare. Test: POST Stripe webhook with checkout.session.completed -> verify ProvisionTenantWorkflow called -> verify tenant created in D1 -> verify TenantBot DO initialized -> verify Telegram sendMessage called. Mock Stripe/Telegram APIs.",
      "filesToCreate": ["tests/provisioning.test.ts"],
      "estimatedEffort": "m",
      "git": {"branchName": "feature/task-019-tests", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-020",
      "type": "code",
      "title": "Deploy to production and verify smoke test",
      "description": "Deploy all Workers + Pages, run end-to-end smoke test",
      "category": "devops",
      "priority": "p0",
      "buildPhase": 8,
      "dependencies": ["task-002", "task-019"],
      "integrationContract": {"exports": ["production deployment verified"]},
      "naomiPrompt": "Trigger GitHub Actions deploy.yml to deploy all Workers to production. Run scripts/smoke-test.ts: create Stripe test checkout -> verify provisioning -> verify bot receives message -> verify dashboard loads. Set up Cloudflare Logpush for error alerting to Telegram.",
      "filesToCreate": ["scripts/smoke-test.ts"],
      "estimatedEffort": "xs",
      "git": {"branchName": "feature/task-020-deploy", "baseBranch": "main", "mergeStrategy": "human-review-required"}
    },
    {
      "id": "task-021",
      "type": "code",
      "title": "GDPR compliance: privacy policy + data deletion endpoint",
      "description": "Legal pages + DELETE /api/tenant/account endpoint",
      "category": "security",
      "priority": "p0",
      "buildPhase": 8,
      "dependencies": ["task-012"],
      "integrationContract": {"exports": ["deleteAllTenantData(tenantId)"], "apiEndpoints": ["DELETE /api/tenant/account"]},
      "naomiPrompt": "Create src/routes/legal/privacy-policy/+page.svelte (multilingual privacy policy). Create DELETE /api/tenant/account endpoint: delete all D1 records for tenant, all R2 conversation objects, revoke Telegram bot token. Implement src/lib/gdpr.ts with deleteAllTenantData(tenantId).",
      "filesToCreate": ["src/routes/legal/privacy-policy/+page.svelte", "src/lib/gdpr.ts"],
      "estimatedEffort": "m",
      "securityReviewRequired": true,
      "git": {"branchName": "feature/task-021-gdpr", "baseBranch": "main", "mergeStrategy": "human-review-required"}
    },
    {
      "id": "task-022",
      "type": "code",
      "title": "Stripe Tax configuration for EU VAT",
      "description": "Enable automatic_tax on all checkout sessions",
      "category": "integration",
      "priority": "p0",
      "buildPhase": 8,
      "dependencies": ["task-011"],
      "integrationContract": {"exports": ["Stripe Tax enabled"]},
      "naomiPrompt": "Update src/lib/stripe.ts createCheckoutSession to set automatic_tax.enabled=true, customer_update.address=true. Enable Stripe Tax in Stripe Dashboard. Verify German 19% VAT, Spanish 21% VAT applied correctly in test mode.",
      "filesToModify": ["src/lib/stripe.ts"],
      "estimatedEffort": "xs",
      "git": {"branchName": "feature/task-022-stripe-tax", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-023",
      "type": "code",
      "title": "Write runbook: incident response + provisioning failure recovery",
      "description": "Markdown runbook for common operational scenarios",
      "category": "documentation",
      "priority": "p1",
      "buildPhase": 8,
      "dependencies": [],
      "integrationContract": {"exports": ["docs/RUNBOOK.md"]},
      "naomiPrompt": "Create docs/RUNBOOK.md covering: (1) Provisioning failure recovery (identify stuck workflows, manual DO spawn), (2) LLM API outage response, (3) Stripe webhook replay, (4) D1 backup restore, (5) Tenant data deletion (GDPR). Include wrangler commands and API endpoints for each scenario.",
      "filesToCreate": ["docs/RUNBOOK.md"],
      "estimatedEffort": "s",
      "git": {"branchName": "feature/task-023-runbook", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    },
    {
      "id": "task-024",
      "type": "code",
      "title": "Build admin platform health dashboard",
      "description": "Admin page showing: active bots, LLM cost, error rate",
      "category": "frontend",
      "priority": "p1",
      "buildPhase": 8,
      "dependencies": ["task-012"],
      "integrationContract": {"exports": ["admin stats API"], "apiEndpoints": ["GET /api/admin/stats"]},
      "naomiPrompt": "Create src/routes/admin/dashboard/+page.svelte showing: total tenants, active bots (30-day conversation count from D1), avg LLM cost per conversation (from messages.tokens_used), provisioning success rate. Create GET /api/admin/stats API. Protect with admin role check.",
      "filesToCreate": ["src/routes/admin/dashboard/+page.svelte", "src/routes/api/admin/stats/+server.ts"],
      "estimatedEffort": "m",
      "git": {"branchName": "feature/task-024-admin-dashboard", "baseBranch": "main", "mergeStrategy": "auto-merge-when-verified"}
    }
  ],
  "marketingTasks": [
    {
      "id": "mkt-001",
      "type": "marketing",
      "title": "Write landing page copy for all 5 locales",
      "description": "Hero, features, pricing, reseller program, FAQ copy for DE/ES/IT/PT-BR/AR",
      "category": "copy",
      "buildPhase": 7,
      "dependencies": [],
      "targetAudience": "DACH digital agencies (Premium resellers), MENA SMB operators, LATAM micro-entrepreneurs",
      "brandVoice": "Direct, no-nonsense, technical but accessible. Emphasize speed (10 seconds), cost (DeepSeek advantage), local language support.",
      "conversionObjective": "Drive reseller signups (DACH) + direct trial signups (MENA/LATAM)",
      "contentTemplate": {"sections": ["headline", "subheadline", "3 value props", "social proof placeholder", "CTA"], "maxWords": 400},
      "competitorExamples": ["ManyChat positioning but for Telegram", "Wati MENA market messaging"],
      "acceptanceCriteria": [{"description": "Headline mentions 10-second provisioning or reseller revenue share", "severity": "blocking"}],
      "humanReviewRequired": true,
      "isOneShottable": true,
      "naomiPrompt": "Write landing page copy for Global-Claw in 5 locales (DE/ES/IT/PT-BR/AR). Headline: emphasize 10-second Telegram bot provisioning OR up to 55% reseller revenue share. Subheadline: white-label AI automation for non-US markets. 3 value props: (1) DeepSeek = 10x cheaper than competitors, (2) Telegram-native (not WhatsApp add-on), (3) reseller program with actual margins. Include FAQ section addressing GDPR (for DACH), Arabic support (for MENA), PPP pricing (for LATAM). Tone: professional, direct, no hype. Max 400 words per locale. Output as JSON: {de: {headline, subheadline, valueProp1, valueProp2, valueProp3, faq}, es: {...}, ...}"
    },
    {
      "id": "mkt-002",
      "type": "marketing",
      "title": "Build programmatic SEO landing page generator",
      "description": "Script generating 500+ locale+vertical landing pages",
      "category": "seo",
      "buildPhase": 7,
      "dependencies": [],
      "targetAudience": "SMBs in target markets searching for vertical-specific Telegram automation",
      "brandVoice": "SEO-optimized but natural, local language",
      "conversionObjective": "Organic search traffic to signup",
      "contentTemplate": {"sections": ["H1 with [vertical] + [city] + telegram bot", "300-word body explaining use case", "CTA to free trial"], "maxWords": 400},
      "acceptanceCriteria": [{"description": "Generates unique pages for 10 cities × 10 verticals × 5 locales = 500 pages", "severity": "blocking"}],
      "humanReviewRequired": false,
      "isOneShottable": true,
      "naomiPrompt": "Create scripts/generate-landing-pages.ts that reads data/cities.json (10 major cities per locale: Berlin, Vienna, Zurich for DE; Barcelona, Madrid for ES; etc.), data/verticals.json (restaurant, clinic, real-estate, retail, consulting, beauty, fitness, legal, accounting, education). For each locale × city × vertical combination, generate marketing/src/routes/[lang]/[vertical]-[city]/+page.svelte with: H1 '[Vertical] Telegram Bot Automation in [City]', 300-word body in local language explaining how Global-Claw helps that vertical in that city, CTA button to /signup. Use SvelteKit SSG to pre-render all pages."
    },
    {
      "id": "mkt-003",
      "type": "marketing",
      "title": "Create reseller onboarding application flow",
      "description": "Application form + Stripe Connect onboarding trigger",
      "category": "campaign",
      "buildPhase": 7,
      "dependencies": [],
      "targetAudience": "DACH agencies, Eastern European SaaS entrepreneurs",
      "brandVoice": "Professional, simple application process",
      "conversionObjective": "Reseller applications submitted",
      "contentTemplate": {"sections": ["Business name", "Country", "Target markets", "Expected tenant volume", "Tier selection"], "maxWords": 100},
      "acceptanceCriteria": [{"description": "Auto-approve Affiliate/Partner tier, manual review for Premium/Master", "severity": "blocking"}],
      "humanReviewRequired": false,
      "isOneShottable": true,
      "naomiPrompt": "Create src/routes/reseller/apply/+page.svelte with form fields: business_name (text), country (select), target_markets (multiselect: DACH/Southern Europe/Eastern Europe/MENA/LATAM), expected_tenant_volume (select: 1-10, 11-50, 51-200, 200+), tier (radio: Affiliate 30%/Partner 40%/Premium 50%/Master 55%). Submit to POST /api/reseller/apply. Backend: auto-approve Affiliate/Partner, set status=pending_review for Premium/Master. On approval, trigger Stripe Connect onboarding, send reseller-welcome email."
    }
  ],
  "pipelineMemoryUsed": [],
  "researchCitationCount": 18,
  "reconciliation": {
    "draftTasksReceived": 23,
    "tasksMerged": 2,
    "securityTasksAdded": 2,
    "glueTasksAdded": 0,
    "testTasksAdded": 1,
    "infraTasksAdded": 2,
    "dependencyCyclesFound": 0,
    "cyclesResolved": 0,
    "contributingPhases": ["product-design", "gtm-marketing", "content-engine", "tech-arch", "analytics", "launch-execution"],
    "lessonsApplied": []
  }
}
